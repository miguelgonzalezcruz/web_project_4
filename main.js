(()=>{"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const t=class{constructor(t,s){e(this,"_hasInvalidInput",(e=>e.some((e=>!e.validity.valid)))),e(this,"_disableSubmitButton",(()=>{this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0})),e(this,"_enableSubmitButton",(()=>{this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1})),e(this,"_toggleButtonState",(e=>{this._hasInvalidInput(e)?this._disableSubmitButton():this._enableSubmitButton()})),this._formElement=s,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._disableSubmitButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}},s={formSelector:"popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible",cardSection:"elements",cardTemplate:"#card-template",cardFormPopupSelector:".create-popup"},i=class{constructor(e){this._popup=document.querySelector(e),this._pressEsc=this._pressEsc.bind(this)}openPopupWindow(){this._popup.classList.add("popup_is-opened"),document.addEventListener("keydown",this._pressEsc)}closePopupWindow(){this._popup.classList.remove("popup_is-opened"),document.removeEventListener("keydown",this._pressEsc)}_pressEsc(e){"Escape"===e.key&&this.closePopupWindow()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("popup")&&this.closePopupWindow()})),this._popup.querySelector(".popup__close").addEventListener("click",(()=>this.closePopupWindow()))}},n=class extends i{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._handleFormSubmit=s,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input"),this._submitButton=this._form.querySelector(".popup__button"),this._submitButtonText=this._submitButton.value}_getInputValues(){return this._data={},this._inputList.forEach((e=>{this._data[e.name]=e.value})),this._data}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}closePopupWindow(){super.closePopupWindow(),this._form.reset()}openPopupWindow(){super.openPopupWindow(),this._submitButton.value=this._submitButtonText}},r=document.querySelector(".profile__info-edit"),o=document.querySelector(".edit-popup"),a=document.querySelector(".popup__content-form"),u=document.querySelector(".profile__add"),l=document.querySelector(".create-popup"),p=a.querySelector(".popup__input_content_name"),c=a.querySelector(".popup__input_content_role"),h=new class extends i{constructor(e){super(e);const t=document.querySelector(".popup__preview-image"),s=document.querySelector(".popup__preview-caption");this.previewImageElement=t,this.previewImageCaption=s}_addImagePreview(){this.previewImageElement.src=this.link,this.previewImageElement.alt=this.name,this.previewImageCaption.textContent=this.name}openPopupWindow(e){this.name=e.name,this.link=e.link,this._addImagePreview(),super.openPopupWindow()}}("#preview-popup");h.setEventListeners();const _=new class{constructor(e){let{userNameInput:t,userJobInput:s,userAvatarInput:i}=e;this._userNameElement=document.querySelector(t),this._userJobElement=document.querySelector(s),this.userAvatarInput=document.querySelector(i)}addAvatar(e){this.userAvatarInput.src=e}addUserInfo(e){let{userNewNameInput:t,userNewJobInput:s}=e;this._userNameElement.textContent=t,this._userJobElement.textContent=s}getUserInfo(){return{userNameInput:this._userNameElement.textContent,userJobInput:this._userJobElement.textContent}}}({userNameInput:".profile__info-title",userJobInput:".profile__info-subtitle",userAvatarInput:".profile__avatar-image"}),m=new class{constructor(e){let{baseUrl:t,headers:s}=e;var i,n;n=e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)),(i="_checkResponse")in this?Object.defineProperty(this,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[i]=n,this._baseUrl=t,this._headers=s}initialize(){return Promise.all([this.getUser(),this.getInitialCards()])}getUser(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((e=>this._checkResponse(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"f0f5b035-9e61-4cc2-926f-83804fb546a7","Content-Type":"application/json"}}),d=new class{constructor(e,t){let{items:s,renderer:i}=e;this._itemsArray=s,this._renderer=i,this._element=document.querySelector(t)}addItem(e){this._element.prepend(e)}renderItems(){this._itemsArray.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Arches National Park",link:"https://images.unsplash.com/photo-1605999212792-bc961b37bb55?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1480&q=80"},{name:"Lake Louise",link:"https://images.unsplash.com/photo-1625229250317-071640d8f9ac?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1450&q=80"},{name:"Olympic National Park",link:"https://images.unsplash.com/photo-1639660451092-58a33eb251e2?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1480&q=80"},{name:"Glacier National Park",link:"https://images.unsplash.com/photo-1517909568143-3eea286ca180?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1480&q=80"},{name:"Yellowstone",link:"https://images.unsplash.com/photo-1579824893947-6ec92314d5de?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1480&q=80"},{name:"Bryce Canyon",link:"https://images.unsplash.com/photo-1651613628753-6c9690b72de2?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1433&q=80"}],renderer:e=>{f(d,e)}},".elements");let b=null;function f(e,t){const s=new class{constructor(e,t,s){this._handleImagePreview=s,this._name=e.name,this._link=e.link,this._cardTemplate=document.querySelector(t).content.querySelector("#element"),this._element,this._previewImage}createCardElement(){return this._element=this._getCardElement(),this._setTextAndImage(),this._setEventListeners(),this._element}_getCardElement(){return this._cardTemplate.cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLike())),this._deleteButton.addEventListener("click",(()=>this._handleDelete())),this._previewImage.addEventListener("click",(()=>this._handleImagePreview()))}_handleLike(){this._likeButton.classList.toggle("active__heart")}_handleDelete(){this._element.remove(),this._element=null}_setTextAndImage(){this._deleteButton=this._element.querySelector(".element__delete-icon"),this._likeButton=this._element.querySelector(".element__content-icon"),this._previewImage=this._element.querySelector(".element__image"),this._previewImage.src=this._link,this._previewImage.alt=this._name,this._element.querySelector(".element__content-title").textContent=this._name}}(t,"#card-template",(()=>{h.openPopupWindow(t)})).createCardElement();e.addItem(s)}Promise.all([m.getUser(),m.getInitialCards()]).then((e=>{let[t,s]=e;_.addAvatar(t.avatar),b=t._id,_.addUserInfo(t),d.setItems(s),d.renderItems()})).catch((e=>{console.log(e)})),d.renderItems();const v=new n({popupSelector:".edit-popup",handleFormSubmit:e=>{_.addUserInfo({userNewNameInput:e.name,userNewJobInput:e.title}),v.closePopupWindow()}});v.setEventListeners();const w=new n({popupSelector:"#create-popup",handleFormSubmit:e=>{f(d,e),w.closePopupWindow()}});w.setEventListeners();const E=new t(s,o),I=new t(s,l);E.enableValidation(),I.enableValidation(),u.addEventListener("click",(()=>{w.openPopupWindow(),I.resetValidation()})),r.addEventListener("click",(()=>{const e=_.getUserInfo();p.value=e.userNameInput,c.value=e.userJobInput,v.openPopupWindow(),E.resetValidation()}))})();
//# sourceMappingURL=main.js.map